<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lobby-Übersicht</title>
    <script src="mainscreen.js" defer></script>
    <link rel="stylesheet" href="mainscreen.css" />
</head>
<body>
    <h1>Lobby</h1>
    <h2 id="pinAnzeige">PIN: </h2>
    <div id="spielerListe">Spieler werden geladen...</div>
    <button id="startButton">Spiel starten</button>
    <button id="spielBeendenBtn">Spiel beenden</button>
    <button id="gameAuswahlBtn" style="display:none; margin:2rem auto 0 auto; padding:1rem 2rem; font-size:1.1rem; background:#ff6ec4; color:#fff; border:none; border-radius:8px; cursor:pointer;">Nächstes Spiel auswählen</button>
    <!-- Popup für Spielauswahl -->
    <div id="popupOverlay">
        <div id="popupMenu">
            <h2>Nächstes Spiel auswählen</h2>
            <div class="game-grid" id="gameGrid">
                <!-- Spielkarten werden per JS eingefügt -->
            </div>
            <button id="spielSetzenBtn" disabled>Spiel setzen</button>
            <div id="auswahlStatus"></div>
        </div>
    </div>
    <script>
        // Prüfe, ob das Spiel gestartet wurde und blende den Button ein/aus
        async function pruefeObGameGestartetUndButton() {
            const pin = new URLSearchParams(window.location.search).get('pin');
            const gameAuswahlBtn = document.getElementById("gameAuswahlBtn");
            try {
                const response = await fetch(`https://kk-backend.vercel.app/gehtsLos?lobby=${pin}`);
                const spielGestartet = await response.json();
                if (spielGestartet) {
                    gameAuswahlBtn.style.display = "block";
                } else {
                    gameAuswahlBtn.style.display = "none";
                }
            } catch (err) {
                gameAuswahlBtn.style.display = "none";
            }
        }

        setInterval(pruefeObGameGestartetUndButton, 1000);

        // ...existing code...
    </script>
</body>
</html>